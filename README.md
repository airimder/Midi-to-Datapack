# Midi to Datapack
 A Python script converting from a .midi file to a format usable in Minecraft: Create Mod to create in-game tracks for pipe organs.

Run the script from the terminal with the arguments: (string) MIDI file path, (string) output nickname, (int) the number of 16th notes one repeater tick should represent, and (int) the number of blocks apart each layer should be. 

The script will output 2 files, a .png file and a .mcfunction file. The .png file shows a color-coded piano-roll style representation of the midi, clamped within the 37-note range. Each pixel along the X-axis represents 1 tick of in-game time; each pixel on the Y-axis represents one semitone, from F#2 at the bottom to F#5 at the top. USE THIS IMAGE to check if it appears the midi has been converted correctly; if the image is not correct, the structure in game will not be, either.

The script will also output a .mcfunction file, which can be executed as part of a custom datapack, placed in the datapack folder of a Minecraft save. Templates are readily available online, but the basic structure of a datapack is something like:


<datapack_name>/   # The name of your datapack

├── pack.mcmeta    # Metadata file (required)

└── data/

    └── <namespace>/
    
        └── functions/
        
            └── main.mcfunction  # The function file you wish to execute, generated by the Python script


Be sure to configure the pack.mcmeta for your specific version of the game.

Executing the mcfunction will generate the circuit to play the MIDI in game 1 block above the player's head and in the positive X and positive Z directions, extending a configurable amount in the X direction and an indefinite amount in the Y and Z directions, depending on the size of the MIDI. Be careful where you execute the function so you do not accidentally overwrite other blocks in your world unintentionally. I would STRONGLY RECOMMEND executing the mcfunction in an empty superflat or void world, and then using tools like Litematica to move it from there once you are satisfied with it. 

Each y-layer in the generated .mcfunction represents one voice. It is recommended to space each layer 3 blocks apart so you have room to move between them for any maintainence or troubleshooting.

In order to use the generated creation, you need to build a Create pipe organ with at least 37 pipes, from F# 2 to F# 5, although it was designed for my Create organ which includes a Nazard (1 octave and a perfect fifth higher than the 8') and a Tierce stop (1 octave and a major third higher than the 8'), for more decorated registrations similar to real-world organs. 

Attach a Redstone Link set to the Receiver mode with the wrench to each pipe. Set the note in the Freq. 2 slot as follows:
            "red_wool",          # F#
            "orange_wool",       # G
            "yellow_wool",       # G#
            "lime_wool",         # A
            "green_wool",        # A#
            "cyan_wool"          # B
            "light_blue_wool",   # C
            "blue_wool",         # C#
            "blue_terracotta",   # D (indigo)
            "purple_wool",       # D#
            "magenta_wool",      # E
            "pink_wool",         # F
Set Freq. 1 according to the "stop", or in this case, rank. 
            narrow diameter: iron_block
            standard diameter: gold_block
            maximal diameter: copper_block
            tierce: emerald_block
            nazard: amethyst_block

While this is a handy tool which will save a considerable amount of time in converting MIDIs into blocks, it is not perfect. The tool is designed to do the majority of the work, but fine-tuning by an organist in-game is usually necessary due to the complexity of the task. The most common error is that notes held for too long will sometimes fail to stop due to their redstone signal not reaching the latch. The solution to this is usually to either shorten the note or to boost the signal with more repeaters, but both have tradeoffs, and so cannot be automated because the decision is too situational to the specific piece being arranged.

This tool is provided without the intention of future maintainence; I am simply sharing a project I worked on to help automate the process I had designed to allow my Create pipe organs to play music.
